@namespace NbpExchangeApp.Components.Pages

@page "/ExchangeTables"

@using NbpExchangeApp.BusinessModels
@using NbpExchangeApp.Services
@inject NbpApiService NbpApiService

@rendermode InteractiveServer

<button type="button" class="btn btn-primary" @onclick="FetchExchangeRates">Fetch Latest Exchange Rates</button>

@if (exchangeRates != null)
{
    <div>
    <br />
    <h4>Exchange Rates</h4>

    <h6>Table: <b>@exchangeRates.No</b></h6>
    <h6>Date: <b>@exchangeRates.EffectiveDate</b></h6>

    <div class="row">
        <div class="col">
            <table class="table table-striped table-hover table-sm">
                <thead>
                    <tr>
                        <th>Currency/Country</th>
                        <th>Currency Code</th>
                        <th>Mid Exchange Rate</th>
                    </tr>
                </thead>
                <tbody>
                    @if (exchangeRates?.Rates != null)
                        {
                            @foreach (var rate in exchangeRates.Rates)
                            {
                                <tr>
                                    <td style="text-align: left;">@rate.Currency</td>
                                    <td style="text-align: center;">@rate.Code</td>
                                    <td style="text-align: right;">@rate.Mid</td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
            </div>
            <div class="col"></div>
        </div>
    </div>
}

@code {
    private ExchangeRates? exchangeRates;

    async Task FetchExchangeRates()
    {
        exchangeRates = await NbpApiService.GetExchangeRatesAsync();
    }
}